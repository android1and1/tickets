// Generated by CoffeeScript 2.3.2
(function() {
  var indexOf = [].indexOf;

  $(function() {
    return $('button#commit').on('click', function(e) {
      var dataArray, fd, fields, i, len, n, name, peer, value, xhr;
      // xhr2 + formData + [key:[]] structor
      // the structor be found in zhongnan hospitol 2019-3-22 evening while
      // A-Pin is ill
      xhr = new XMLHttpRequest;
      xhr.open('POST', '/play-version-xhr2');
      xhr.responseType = 'json';
      xhr.onloadend = function(e) {
        var a, json, results;
        json = this.response;
        console.log('Server Said', json);
        results = [];
        for (a in json) {
          results.push(alert(a + ':' + json[a]));
        }
        return results;
      };
      // collect data
      fd = new FormData;
      dataArray = $('form').serializeArray();
      fields = {};
      for (i = 0, len = dataArray.length; i < len; i++) {
        peer = dataArray[i];
        name = peer.name;
        value = peer.value;
        if (indexOf.call(Object.keys(fields), name) < 0) {
          fields[name] = [];
        }
        fields[name].push(value);
      }
      for (n in fields) {
        fd.append(n, fields[n]);
      }
      return xhr.send(fd);
    });
  });

}).call(this);
